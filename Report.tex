% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={The Report},
  pdfauthor={Süleyman Erim, Giacomo Schiavo, Mattia Varagnolo},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{The Report}
\author{Süleyman Erim, Giacomo Schiavo, Mattia Varagnolo}
\date{2023-07-25}

\begin{document}
\maketitle

\hypertarget{introduction-to-data}{%
\section{Introduction to data}\label{introduction-to-data}}

This section introduces the purpose of the exploratory data analysis
(EDA) and sets up the necessary libraries and data files.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# import libraries}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(tinytex)}
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(corrplot)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(gridExtra)}
\FunctionTok{library}\NormalTok{(correlation)}
\FunctionTok{library}\NormalTok{(reshape)}
\FunctionTok{library}\NormalTok{(reshape2)}
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\# for data manipulation}
\FunctionTok{library}\NormalTok{(ggplot2) }\CommentTok{\# for plotting}
\FunctionTok{library}\NormalTok{(gridExtra) }\CommentTok{\# for grid.arrange}
\FunctionTok{library}\NormalTok{(regclass) }\CommentTok{\# for VIF package}
\FunctionTok{library}\NormalTok{(MLmetrics) }\CommentTok{\# to create confusion matrix}
\FunctionTok{library}\NormalTok{(pROC) }\CommentTok{\# for ROC Curve}
\FunctionTok{library}\NormalTok{(e1071) }\CommentTok{\# for Naive Bayes Classifier}
\FunctionTok{library}\NormalTok{(class)}
\FunctionTok{library}\NormalTok{(caret)}
\FunctionTok{library}\NormalTok{(corrr)}
\FunctionTok{library}\NormalTok{(ppcor)}
\FunctionTok{library}\NormalTok{(glmnet) }\CommentTok{\# for Lasso Regression}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_train }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"train.csv"}\NormalTok{)}
\NormalTok{data\_test }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"test.csv"}\NormalTok{)}

\CommentTok{\# merge train and test data}
\NormalTok{data }\OtherTok{=} \FunctionTok{rbind}\NormalTok{(data\_train, data\_test)}
\FunctionTok{attach}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-analysis}{%
\section{Data Analysis}\label{data-analysis}}

In this project, we will develop a predictive model to determine whether
a passenger will be satisfied or dissatisfied with the services offered
by an airline company. The dataset used for this project is a survey on
airline passenger satisfaction, which contains information about
passengers' demographics, travel preferences, and satisfaction with
various aspects of their flights.

The dataset:
\url{https://www.kaggle.com/datasets/teejmahal20/airline-passenger-satisfaction}

\hypertarget{description-of-our-variables}{%
\subsection{Description of our
variables}\label{description-of-our-variables}}

Here are the variables in the dataset:

\begin{itemize}
\tightlist
\item
  Gender: Gender of the passengers (Female, Male)
\item
  Customer Type: The customer type (Loyal customer, disloyal customer)
\item
  Age: The actual age of the passengers
\item
  Type of Travel: Purpose of the flight of the passengers (Personal
  Travel, Business Travel)
\item
  Class: Travel class in the plane of the passengers (Business, Eco, Eco
  Plus)
\item
  Flight distance: The flight distance of this journey
\item
  Inflight wifi service: Satisfaction level of the inflight wifi service
  (0: Not Applicable; 1-5)
\item
  Departure/Arrival time convenient: Satisfaction level of
  Departure/Arrival time convenient
\item
  Ease of Online booking: Satisfaction level of online booking
\item
  Gate location: Satisfaction level of Gate location
\item
  Food and drink: Satisfaction level of Food and drink
\item
  Online boarding: Satisfaction level of online boarding
\item
  Seat comfort: Satisfaction level of Seat comfort
\item
  Inflight entertainment: Satisfaction level of inflight entertainment
\item
  On-board service: Satisfaction level of On-board service
\item
  Leg room service: Satisfaction level of Leg room service
\item
  Baggage handling: Satisfaction level of baggage handling
\item
  Check-in service: Satisfaction level of Check-in service
\item
  Inflight service: Satisfaction level of inflight service
\item
  Cleanliness: Satisfaction level of Cleanliness
\item
  Departure Delay in Minutes: Minutes delayed when departure
\item
  Arrival Delay in Minutes: Minutes delayed when Arrival
\item
  Satisfaction: Airline satisfaction level (Satisfaction, neutral or
  dissatisfaction)
\end{itemize}

The objective of our report is to predict passenger satisfaction with
airline services based on the provided dataset, which includes various
demographic and satisfaction-related variables such as gender, age,
travel type, flight class, and satisfaction levels with different
aspects of the journey. The dataset represents a survey on airline
passenger satisfaction and will be used to develop a predictive model to
determine whether passengers will be satisfied or dissatisfied with the
airline services.

Now we're going to get a summary of all the features in our dataset:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        X                id            Gender          Customer.Type     
##  Min.   :     0   Min.   :     1   Length:129880      Length:129880     
##  1st Qu.: 16235   1st Qu.: 32471   Class :character   Class :character  
##  Median : 38964   Median : 64941   Mode  :character   Mode  :character  
##  Mean   : 44159   Mean   : 64941                                        
##  3rd Qu.: 71433   3rd Qu.: 97410                                        
##  Max.   :103903   Max.   :129880                                        
##                                                                         
##       Age        Type.of.Travel        Class           Flight.Distance
##  Min.   : 7.00   Length:129880      Length:129880      Min.   :  31   
##  1st Qu.:27.00   Class :character   Class :character   1st Qu.: 414   
##  Median :40.00   Mode  :character   Mode  :character   Median : 844   
##  Mean   :39.43                                         Mean   :1190   
##  3rd Qu.:51.00                                         3rd Qu.:1744   
##  Max.   :85.00                                         Max.   :4983   
##                                                                       
##  Inflight.wifi.service Departure.Arrival.time.convenient Ease.of.Online.booking
##  Min.   :0.000         Min.   :0.000                     Min.   :0.000         
##  1st Qu.:2.000         1st Qu.:2.000                     1st Qu.:2.000         
##  Median :3.000         Median :3.000                     Median :3.000         
##  Mean   :2.729         Mean   :3.058                     Mean   :2.757         
##  3rd Qu.:4.000         3rd Qu.:4.000                     3rd Qu.:4.000         
##  Max.   :5.000         Max.   :5.000                     Max.   :5.000         
##                                                                                
##  Gate.location   Food.and.drink  Online.boarding  Seat.comfort  
##  Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :3.000   Median :3.000   Median :3.000   Median :4.000  
##  Mean   :2.977   Mean   :3.205   Mean   :3.253   Mean   :3.441  
##  3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:5.000  
##  Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
##                                                                 
##  Inflight.entertainment On.board.service Leg.room.service Baggage.handling
##  Min.   :0.000          Min.   :0.000    Min.   :0.000    Min.   :1.000   
##  1st Qu.:2.000          1st Qu.:2.000    1st Qu.:2.000    1st Qu.:3.000   
##  Median :4.000          Median :4.000    Median :4.000    Median :4.000   
##  Mean   :3.358          Mean   :3.383    Mean   :3.351    Mean   :3.632   
##  3rd Qu.:4.000          3rd Qu.:4.000    3rd Qu.:4.000    3rd Qu.:5.000   
##  Max.   :5.000          Max.   :5.000    Max.   :5.000    Max.   :5.000   
##                                                                           
##  Checkin.service Inflight.service  Cleanliness    Departure.Delay.in.Minutes
##  Min.   :0.000   Min.   :0.000    Min.   :0.000   Min.   :   0.00           
##  1st Qu.:3.000   1st Qu.:3.000    1st Qu.:2.000   1st Qu.:   0.00           
##  Median :3.000   Median :4.000    Median :3.000   Median :   0.00           
##  Mean   :3.306   Mean   :3.642    Mean   :3.286   Mean   :  14.71           
##  3rd Qu.:4.000   3rd Qu.:5.000    3rd Qu.:4.000   3rd Qu.:  12.00           
##  Max.   :5.000   Max.   :5.000    Max.   :5.000   Max.   :1592.00           
##                                                                             
##  Arrival.Delay.in.Minutes satisfaction      
##  Min.   :   0.00          Length:129880     
##  1st Qu.:   0.00          Class :character  
##  Median :   0.00          Mode  :character  
##  Mean   :  15.09                            
##  3rd Qu.:  13.00                            
##  Max.   :1584.00                            
##  NA's   :393
\end{verbatim}

Calculate the proportion of satisfied and dissatisfied customers in the
dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{prop.table}\NormalTok{(}\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{satisfaction))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## neutral or dissatisfied               satisfied 
##               0.5655374               0.4344626
\end{verbatim}

From the summary, it is evident that many features represent ratings on
the services provided by the airline agency, and these ratings range
from 0 to 5. Additionally, we noticed that the ``Arrival Delay in
Minutes'' feature contains some missing values (NA).

Next, we will examine the distribution of all nominal features.
Specifically, we have categorical data for Gender, Customer Type, Type
of Travel, and Class, while all the rating features are ordinal.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Gender)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Female   Male 
##  65899  63981
\end{verbatim}

The ``Gender'' feature appears to be well-balanced, meaning that it has
an approximately equal number of occurrences for each category, likely
male and female. This balance can be beneficial for modeling as it
prevents any significant bias towards a particular gender in the
analysis and predictions.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Customer.Type)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## disloyal Customer    Loyal Customer 
##             23780            106100
\end{verbatim}

The ``Customer Type'' feature contains only two values, ``disloyal
customer'' and ``loyal customer.'' The distribution of values is
imbalanced, with one category potentially having significantly more
occurrences than the other.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Type.of.Travel)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Business travel Personal Travel 
##           89693           40187
\end{verbatim}

The ``Type of Travel'' feature consists of only two values: ``personal
travel'' and ``business travel.'' The distribution of values is
imbalanced, with ``business travel'' occurring twice as much as
``personal travel.''

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Class)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Business      Eco Eco Plus 
##    62160    58309     9411
\end{verbatim}

The ``Class'' feature contains three values: ``business,'' ``eco plus,''
and ``eco.'' The distribution of values is imbalanced. ``Business'' and
``eco'' classes appear to be relatively balanced, while ``eco plus'' is
significantly underrepresented compared to the other two classes.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{satisfaction)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## neutral or dissatisfied               satisfied 
##                   73452                   56428
\end{verbatim}

The ``satisfaction'' feature, which serves as our target variable, is an
important aspect of the analysis. The values for this feature are not
perfectly balanced, meaning that there is an unequal distribution of
satisfied and dissatisfied passengers in the dataset.

\hypertarget{data-preprocessing}{%
\subsection{Data preprocessing}\label{data-preprocessing}}

In this section of data preprocessing, several steps are performed to
prepare the dataset for further analysis and modeling. The specific
actions taken include:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Renaming columns: the names of the features (columns) are modified to
  improve their clarity and usability.
\item
  Dropping unnecessary columns: two columns, ``X'' and ``id,'' are
  removed from the dataset. The ``X'' column likely represents the index
  of the row, which does not carry any meaningful information for
  analysis. The ``id'' column is presumed to be an unknown indexing
  number, which may not contribute to the predictive modeling process.
\item
  Converting categorical variables to factors: categorical variables,
  such as ``Gender'', ``Customer Type'', ``Type of Travel'' and
  ``Class'' are converted into factors.
\end{enumerate}

By performing these data preprocessing steps, the dataset is cleaned and
transformed into a more suitable format for the subsequent analysis,
making it easier to build a predictive model for passenger satisfaction.

\hypertarget{renaming-columns-and-removing-features}{%
\subsubsection{Renaming columns and removing
features}\label{renaming-columns-and-removing-features}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# replace dots with underscores in column names}
\FunctionTok{names}\NormalTok{(data) }\OtherTok{=} \FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{."}\NormalTok{, }\StringTok{"\_"}\NormalTok{, }\FunctionTok{names}\NormalTok{(data))}
\CommentTok{\# drop X and id column}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{X, }\SpecialCharTok{{-}}\NormalTok{id)}
\FunctionTok{names}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "Gender"                            "Customer_Type"                    
##  [3] "Age"                               "Type_of_Travel"                   
##  [5] "Class"                             "Flight_Distance"                  
##  [7] "Inflight_wifi_service"             "Departure_Arrival_time_convenient"
##  [9] "Ease_of_Online_booking"            "Gate_location"                    
## [11] "Food_and_drink"                    "Online_boarding"                  
## [13] "Seat_comfort"                      "Inflight_entertainment"           
## [15] "On_board_service"                  "Leg_room_service"                 
## [17] "Baggage_handling"                  "Checkin_service"                  
## [19] "Inflight_service"                  "Cleanliness"                      
## [21] "Departure_Delay_in_Minutes"        "Arrival_Delay_in_Minutes"         
## [23] "satisfaction"
\end{verbatim}

\hypertarget{convert-categorical-features-to-factors}{%
\subsubsection{Convert categorical features to
factors}\label{convert-categorical-features-to-factors}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# convert categorical features to factor}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Gender }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Gender)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Customer\_Type }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Customer\_Type)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Type\_of\_Travel }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Type\_of\_Travel)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Class }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Class)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{satisfaction }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{satisfaction)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Arrival\_Delay\_in\_Minutes }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Arrival\_Delay\_in\_Minutes)}


\NormalTok{ratings\_fts\_names }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Inflight\_wifi\_service"}\NormalTok{, }\StringTok{"Departure\_Arrival\_time\_convenient"}\NormalTok{, }
  \StringTok{"Ease\_of\_Online\_booking"}\NormalTok{, }\StringTok{"Gate\_location"}\NormalTok{, }\StringTok{"Food\_and\_drink"}\NormalTok{, }\StringTok{"Online\_boarding"}\NormalTok{, }
  \StringTok{"Seat\_comfort"}\NormalTok{, }\StringTok{"Inflight\_entertainment"}\NormalTok{, }\StringTok{"On\_board\_service"}\NormalTok{, }\StringTok{"Leg\_room\_service"}\NormalTok{, }
  \StringTok{"Baggage\_handling"}\NormalTok{, }\StringTok{"Checkin\_service"}\NormalTok{, }\StringTok{"Inflight\_service"}\NormalTok{, }\StringTok{"Cleanliness"}\NormalTok{, }\StringTok{"On\_board\_service"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ ratings\_fts\_names) \{}
\NormalTok{  data[[col]] }\OtherTok{=} \FunctionTok{as.factor}\NormalTok{(data[[col]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{handling-na-values}{%
\subsection{Handling na values}\label{handling-na-values}}

In this section, we analyze the dataset to identify variables with
missing values, particularly focusing on the
``Arrival\_Delay\_in\_Minutes'' variable. We calculate the proportion of
missing values for this variable and subsequently remove the examples or
rows with missing values from the dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# list features with na values}
\FunctionTok{prop.table}\NormalTok{(}\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                            Gender                     Customer_Type 
##                                 0                                 0 
##                               Age                    Type_of_Travel 
##                                 0                                 0 
##                             Class                   Flight_Distance 
##                                 0                                 0 
##             Inflight_wifi_service Departure_Arrival_time_convenient 
##                                 0                                 0 
##            Ease_of_Online_booking                     Gate_location 
##                                 0                                 0 
##                    Food_and_drink                   Online_boarding 
##                                 0                                 0 
##                      Seat_comfort            Inflight_entertainment 
##                                 0                                 0 
##                  On_board_service                  Leg_room_service 
##                                 0                                 0 
##                  Baggage_handling                   Checkin_service 
##                                 0                                 0 
##                  Inflight_service                       Cleanliness 
##                                 0                                 0 
##        Departure_Delay_in_Minutes          Arrival_Delay_in_Minutes 
##                                 0                                 1 
##                      satisfaction 
##                                 0
\end{verbatim}

To determine the proportion of missing values for the
``Arrival\_Delay\_in\_Minutes'' variable, we can count the number of
instances where this variable has missing values (commonly denoted as
``NaN'' or ``NA'') and divide it by the total number of examples in the
dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Arrival\_Delay\_in\_Minutes has na values, proportion of na values}
\FunctionTok{prop.table}\NormalTok{(}\FunctionTok{table}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Arrival\_Delay\_in\_Minutes)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##      FALSE       TRUE 
## 0.99697413 0.00302587
\end{verbatim}

Indeed, since the proportion of missing values for the
``Arrival\_Delay\_in\_Minutes'' variable is very low (less than 3\% of
the entire dataset), it is reasonable to proceed with dropping these
missing values from the dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# drop na values in Arrival\_Delay\_in\_Minutes}
\NormalTok{data }\OtherTok{=}\NormalTok{ data[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Arrival\_Delay\_in\_Minutes),]}

\FunctionTok{any}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(data))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE
\end{verbatim}

\hypertarget{outliers}{%
\subsection{Outliers}\label{outliers}}

In this section, box plots are created for each numeric variable present
in the dataset. Box plots are a powerful visualization tool used to
identify the presence of outliers in the data. For each numeric
variable, the box plot displays a box that represents the interquartile
range (IQR), with the median indicated by a line inside the box. The
``lines'' extending from the box show the range of the data, and any
data points beyond the lines are considered potential outliers.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plot boxplot of each numeric variable excluding ratings features}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.numeric)]) \{}
  \ControlFlowTok{if}\NormalTok{ (col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]])) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =}\NormalTok{ col, }\AttributeTok{x =}\NormalTok{ col, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }
\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot}
\NormalTok{\}}

\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-15-1.pdf} We
can see that there are outliers in Departure\_Delay\_in\_Minutes,
Arrival\_Delay\_in\_Minutes and Flight\_Distance. Considering the
presence of both near-zero and very large values in the dataset,
alternative distributions like the log-normal distribution may be more
appropriate for modeling the ``Departure\_Delay\_in\_Minutes'' and
``Arrival\_Delay\_in\_Minutes'' variables, as they can better capture
the variability in delay times. Since we have decided to keep the
outliers in the dataset, it's essential to understand their potential
impact on our analysis and modeling. Outliers are data points that
deviate significantly from the rest of the data and can introduce noise
or bias in statistical analyses and machine learning models.

In the context of ``Departure\_Delay\_in\_Minutes,''
``Arrival\_Delay\_in\_Minutes,'' and ``Flight\_Distance,'' outliers
might represent extreme values that could be caused by various factors,
such as severe weather conditions, operational disruptions, or
exceptional circumstances. By retaining these outliers, we acknowledge
that such extreme situations can occur and affect the overall flight
delay and distance patterns.

\hypertarget{visualization}{%
\section{Visualization}\label{visualization}}

In this section, histograms are used to visualize the distribution of
the variables in the dataset, starting with the nominal features so that
we can gain insights into the distribution of categories within each
feature.

Upon visualizing the nominal features, it becomes apparent that some
features exhibit heavily unbalanced distributions. This means that
certain categories within these features have significantly higher
frequencies compared to others. The presence of such imbalanced
distributions could have implications for analysis and modeling, as it
may lead to biased results or difficulties in predicting less frequent
categories accurately.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plot distribution of categorical variables}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.factor)]) \{}
  \ControlFlowTok{if}\NormalTok{ (col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]], }\AttributeTok{fill =}\NormalTok{ .data[[col]])) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of"}\NormalTok{, col), }\AttributeTok{x =}\NormalTok{ col, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{fill =} \ConstantTok{FALSE}\NormalTok{)}

\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The `<scale>` argument of `guides()` cannot be `FALSE`. Use "none" instead as
## of ggplot2 3.3.4.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-16-1.pdf} From
the analysis of the nominal features, we can observe the following
regarding their balance:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Gender: it is almost perfectly balanced, meaning that there is a
  relatively equal representation of both genders in the dataset.
\item
  Satisfaction: the target feature appears to be slightly imbalanced,
  with fewer instances of ``satisfied'' compared to the other class
  (``dissatisfied'').
\item
  Type of Travel: it shows an imbalance, with more instances of
  ``business travel'' compared to ``personal travel.'' We can assume
  that the majority of people in this dataset travel for business.
\item
  Class: it also exhibits imbalance, with ``business'' and ``eco''
  classes having relatively balanced representations, while the ``Eco
  Plus'' class is underrepresented.
\item
  Customer Type: it shows an imbalance, with a higher number of ``loyal
  customer'' instances compared to ``disloyal customer.''
\end{enumerate}

When dealing with imbalanced data, we need to take specific measures
during model training and evaluation to ensure that the model performs
well and doesn't exhibit bias towards the majority class. Appropriate
techniques such as resampling, using different evaluation metrics or
employing specialized algorithms can help address the imbalance and lead
to a more accurate and fair predictive model.

Now we plot the distribution of ratings features.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plot distribution of ratings features}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\NormalTok{my\_palette }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"\#1f78b4"}\NormalTok{, }\StringTok{"\#33a02c"}\NormalTok{, }\StringTok{"\#e31a1c"}\NormalTok{, }\StringTok{"\#ff7f00"}\NormalTok{, }\StringTok{"\#6a3d9a"}\NormalTok{, }\StringTok{"\#b15928"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.factor)]) \{}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]], }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(.data[[col]]))) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_text}\NormalTok{(}\AttributeTok{stat =} \StringTok{\textquotesingle{}count\textquotesingle{}}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{after\_stat}\NormalTok{(count))) }\SpecialCharTok{+}  
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of "}\NormalTok{, col), }\AttributeTok{x =}\NormalTok{ col, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =}\NormalTok{ my\_palette) }\SpecialCharTok{+}
    \FunctionTok{guides}\NormalTok{(}\AttributeTok{fill =} \ConstantTok{FALSE}\NormalTok{)}

\NormalTok{  plots[[col]] }\OtherTok{\textless{}{-}}\NormalTok{ plot}
\NormalTok{\}}
\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-17-1.pdf} Based
on the graphs showing the histograms of the ratings, we can observe that
the majority of them tend to fall between 3 and 4. This conclusion is
drawn from the visual representation of the data, where the histogram
bars are higher in the range of 3 to 4, indicating a higher frequency of
ratings in that range.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# compute the mean value of all the ratings}
\NormalTok{ratings\_data }\OtherTok{=}\NormalTok{ data[, }\FunctionTok{c}\NormalTok{(ratings\_fts\_names)]}
\NormalTok{ratings\_data }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(ratings\_data, }\DecValTok{2}\NormalTok{, as.numeric)}
\NormalTok{ratings\_mean }\OtherTok{=} \FunctionTok{colMeans}\NormalTok{(ratings\_data)}
\NormalTok{ratings\_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Inflight_wifi_service Departure_Arrival_time_convenient 
##                          2.728544                          3.057349 
##            Ease_of_Online_booking                     Gate_location 
##                          2.756786                          2.976909 
##                    Food_and_drink                   Online_boarding 
##                          3.204685                          3.252720 
##                      Seat_comfort            Inflight_entertainment 
##                          3.441589                          3.358067 
##                  On_board_service                  Leg_room_service 
##                          3.383204                          3.351078 
##                  Baggage_handling                   Checkin_service 
##                          3.631886                          3.306239 
##                  Inflight_service                       Cleanliness 
##                          3.642373                          3.286222 
##                On_board_service.1 
##                          3.383204
\end{verbatim}

This section presents histograms to visualize the distribution of
numeric variables in the dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plot distribution and density of numeric variables excluding ratings features}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.numeric)]) \{}
  \ControlFlowTok{if}\NormalTok{ (col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]])) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(density)), }\AttributeTok{bins =} \DecValTok{30}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{fill =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of"}\NormalTok{, col), }\AttributeTok{x =}\NormalTok{ col, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }

\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot}
\NormalTok{\}}

\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-19-1.pdf}

The histograms provide a useful overview of the distribution of the
numeric variables in the dataset. This information can be used to
identify potential outliers, and to choose appropriate statistical
methods for analyzing the data:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  The age distribution is bimodal, which means that it has two distinct
  peaks. This could be due to a number of factors, such as the airline's
  target customer base, or the typical age of people who travel by air.
\item
  The flight distance distribution is log-normal, which means that it is
  skewed to the left. This is likely due to the fact that there are a
  few very long flights, which skew the distribution.
\item
  The departure delay and arrival delay distributions are very similar,
  which suggests that they are caused by the same factors. These factors
  could include weather conditions, air traffic control delays, or
  mechanical problems with the aircraft.
\end{enumerate}

\hypertarget{variables-vs-target}{%
\subsection{Variables vs Target}\label{variables-vs-target}}

\hypertarget{categorical-variables-vs-target}{%
\subsubsection{Categorical Variables vs
Target}\label{categorical-variables-vs-target}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plots categorical variables vs satisfaction}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.factor)]) \{}
  \ControlFlowTok{if}\NormalTok{ (col }\SpecialCharTok{==} \StringTok{"satisfaction"} \SpecialCharTok{||}\NormalTok{ col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ satisfaction, }\AttributeTok{fill =}\NormalTok{ .data[[col]])) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of Satisfaction by"}\NormalTok{, col), }\AttributeTok{x =} \StringTok{"Satisfaction"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{)}

\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot}
  
\NormalTok{\}}

\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-20-1.pdf} The
observations from the graph analysis provide valuable insights into how
different nominal features relate to passenger satisfaction:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Gender: both males and females appear to have similar distributions in
  terms of satisfaction, indicating that gender may not be a strong
  predictor of passenger satisfaction. The distributions closely
  resemble the overall distribution of the satisfaction feature.
\item
  Customer type: the graph suggests that ``disloyal customers'' are more
  likely to be unsatisfied or neutral compared to ``loyal customers.''
  This indicates that customer loyalty may play a role in passenger
  satisfaction, with loyal customers tending to be more satisfied.
\item
  Type of travel: The graph indicates that ``personal travelers'' are
  more likely to be unsatisfied compared to ``business travelers.''
  Conversely, ``business travelers'' tend to have a higher proportion of
  satisfied passengers. This finding suggests that the purpose of travel
  may have an influence on passenger satisfaction.
\item
  Class: The graph shows that ``business class'' passengers are more
  satisfied than unsatisfied, whereas ``eco'' and ``eco plus''
  passengers tend to have a higher proportion of unsatisfied passengers.
  This suggests that the class of service provided by the airline may be
  a significant factor affecting passenger satisfaction.
\end{enumerate}

\hypertarget{rating-features-vs-target}{%
\subsubsection{Rating Features vs
Target}\label{rating-features-vs-target}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plots ratings features vs satisfaction}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.factor)]) \{}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]], }\AttributeTok{fill =}\NormalTok{ satisfaction)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of Satisfaction by"}\NormalTok{, col), }\AttributeTok{x =} \StringTok{"Satisfaction"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{)}

\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot  }
\NormalTok{\}}

\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-21-1.pdf}

Based on the observed distribution of the ratings, we can draw the
following conclusion:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For most of the ratings, the mean value for unsatisfied/neutral
  consumers is around 3, except for ``Inflight Service'' and ``Baggage
  Handling.''
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# calculate the mean of the ratings of unsatisfied/neutral consumers}
\NormalTok{ratings\_data }\OtherTok{=}\NormalTok{ data[data}\SpecialCharTok{$}\NormalTok{satisfaction }\SpecialCharTok{==} \StringTok{"neutral or dissatisfied"}\NormalTok{, }\FunctionTok{c}\NormalTok{(ratings\_fts\_names)]}
\NormalTok{ratings\_data }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(ratings\_data, }\DecValTok{2}\NormalTok{, as.numeric)}
\NormalTok{ratings\_mean }\OtherTok{=} \FunctionTok{colMeans}\NormalTok{(ratings\_data)}
\NormalTok{ratings\_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Inflight_wifi_service Departure_Arrival_time_convenient 
##                          2.398470                          3.130229 
##            Ease_of_Online_booking                     Gate_location 
##                          2.549512                          2.980184 
##                    Food_and_drink                   Online_boarding 
##                          2.958525                          2.658846 
##                      Seat_comfort            Inflight_entertainment 
##                          3.038525                          2.892236 
##                  On_board_service                  Leg_room_service 
##                          3.019570                          2.990495 
##                  Baggage_handling                   Checkin_service 
##                          3.374681                          3.043045 
##                  Inflight_service                       Cleanliness 
##                          3.389662                          2.932851 
##                On_board_service.1 
##                          3.019570
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  For most of the ratings given by satisfied consumers, the mean value
  is around 4. However, it's important to note that we cannot generalize
  from this information alone.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# calculate the mean of the ratings of unsatisfied/neutral consumers}
\NormalTok{ratings\_data }\OtherTok{=}\NormalTok{ data[data}\SpecialCharTok{$}\NormalTok{satisfaction }\SpecialCharTok{==} \StringTok{"satisfied"}\NormalTok{, }\FunctionTok{c}\NormalTok{(ratings\_fts\_names)]}
\NormalTok{ratings\_data }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(ratings\_data, }\DecValTok{2}\NormalTok{, as.numeric)}
\NormalTok{ratings\_mean }\OtherTok{=} \FunctionTok{colMeans}\NormalTok{(ratings\_data)}
\NormalTok{ratings\_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Inflight_wifi_service Departure_Arrival_time_convenient 
##                          3.158135                          2.962497 
##            Ease_of_Online_booking                     Gate_location 
##                          3.026554                          2.972646 
##                    Food_and_drink                   Online_boarding 
##                          3.525061                          4.025648 
##                      Seat_comfort            Inflight_entertainment 
##                          3.966176                          3.964345 
##                  On_board_service                  Leg_room_service 
##                          3.856475                          3.820376 
##                  Baggage_handling                   Checkin_service 
##                          3.966638                          3.648786 
##                  Inflight_service                       Cleanliness 
##                          3.971277                          3.746134 
##                On_board_service.1 
##                          3.856475
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  we can see that certain ratings, such as ``Online\_boarding,''
  ``Seat\_comfort,'' ``Inflight\_entertainment,''
  ``On\_board\_service,'' and ``Leg\_room\_service,'' exhibit similar
  distributions. The neutral/unsatisfied votes appear to follow a normal
  curve centered around a mean of approximately 3, while the satisfied
  votes tend to concentrate on grades 4 and 5. This pattern strongly
  suggests that these ratings are not independent but rather correlated
  with each other.
\end{enumerate}

\hypertarget{numerical-variables-vs-target}{%
\subsubsection{Numerical Variables vs
Target}\label{numerical-variables-vs-target}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plots numeric variables vs satisfaction excluding ratings features with histograms of different colors for each satisfaction level}
\NormalTok{plots }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(data)[}\FunctionTok{sapply}\NormalTok{(data, is.numeric)]) \{}
  \ControlFlowTok{if}\NormalTok{ (col }\SpecialCharTok{\%in\%}\NormalTok{ ratings\_fts\_names) \{}
    \ControlFlowTok{next}
\NormalTok{  \}}
\NormalTok{  plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .data[[col]], }\AttributeTok{fill =}\NormalTok{ satisfaction, }\AttributeTok{group =}\NormalTok{ satisfaction)) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{bins =} \DecValTok{30}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of"}\NormalTok{, col), }\AttributeTok{x =}\NormalTok{ col, }\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }

\NormalTok{  plots[[col]] }\OtherTok{=}\NormalTok{ plot}
\NormalTok{\}}

\FunctionTok{grid.arrange}\NormalTok{(}\AttributeTok{grobs =}\NormalTok{ plots, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-24-1.pdf} Based
on the boxplots and the information provided, we can make the following
observations about the distributions of the numerical features:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Age: the boxplot for ``Age'' suggests that the distribution is
  approximately normal. Furthermore, it appears that neutral or
  dissatisfied customers tend to be slightly younger on average compared
  to satisfied customers.
\item
  Flight Distance: the boxplot does not exhibit a normal distribution.
  Instead, it appears to have a right-skewed distribution. This is
  evident from the longer whisker on the right side, indicating that
  there are some outliers with larger flight distances.
\item
  Departure Delay in Minutes: the boxplot for ``Departure Delay in
  Minutes'' also shows a right-skewed distribution. The majority of the
  data appears to be concentrated towards the lower values, with a lot
  of outliers representing longer departure delays.
\item
  Arrival Delay in Minutes: similar to the ``Departure Delay in
  Minutes,'' the boxplot for ``Arrival Delay in Minutes'' exhibits a
  right-skewed distribution. The bulk of the data is clustered towards
  the lower values, with a lot of outliers indicating longer arrival
  delays.
\end{enumerate}

Based on these observations, it's essential to consider the appropriate
data transformations or use different distribution models when working
with ``Flight Distance,'' ``Departure Delay in Minutes,'' and ``Arrival
Delay in Minutes.'' For example, logarithmic transformations may be
suitable to handle the skewed nature of these variables in statistical
analyses and modeling tasks.

\hypertarget{correlation-matrix}{%
\subsection{CORRELATION MATRIX}\label{correlation-matrix}}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# CORRELATION MATRIX FOR NUMERICAL VARIABLES}

\NormalTok{ds\_cor1 }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(data,}\AttributeTok{select =} \FunctionTok{c}\NormalTok{(Age,Flight\_Distance,Departure\_Delay\_in\_Minutes,Arrival\_Delay\_in\_Minutes)))}
\FunctionTok{summary}\NormalTok{(ds\_cor1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Age            Flight_Distance     Departure_Delay_in_Minutes
##  Min.   :-0.011248   Min.   :-0.001935   Min.   :-0.0092626        
##  1st Qu.:-0.009759   1st Qu.: 0.001010   1st Qu.:-0.0008216        
##  Median : 0.045300   Median : 0.050928   Median : 0.4836416        
##  Mean   : 0.269838   Mean   : 0.274980   Mean   : 0.4895052        
##  3rd Qu.: 0.324897   3rd Qu.: 0.324897   3rd Qu.: 0.9739684        
##  Max.   : 1.000000   Max.   : 1.000000   Max.   : 1.0000000        
##  Arrival_Delay_in_Minutes
##  Min.   :-0.011248       
##  1st Qu.:-0.004263       
##  Median : 0.481678       
##  Mean   : 0.488027       
##  3rd Qu.: 0.973968       
##  Max.   : 1.000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{repr.plot.width =} \DecValTok{14}\NormalTok{, }\AttributeTok{repr.plot.height =} \DecValTok{8}\NormalTok{)}
\FunctionTok{corrplot}\NormalTok{(ds\_cor1, }\AttributeTok{na.label =} \StringTok{" "}\NormalTok{, }\AttributeTok{method=}\StringTok{"color"}\NormalTok{, }\AttributeTok{tl.col =} \StringTok{"black"}\NormalTok{, }\AttributeTok{tl.cex =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-26-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# CORRELATION MATRIX FOR ORDINAL VARIABLES}
\NormalTok{ordinal\_variables }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Inflight\_wifi\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Departure\_Arrival\_time\_convenient\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Ease\_of\_Online\_booking\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Gate\_location\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Food\_and\_drink\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Online\_boarding\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Seat\_comfort\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Inflight\_entertainment\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}On\_board\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Leg\_room\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Baggage\_handling\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Checkin\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Inflight\_service\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cleanliness\textquotesingle{}}\NormalTok{)}

\CommentTok{\# for each ordinal variables, change the values to numeric}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ ordinal\_variables) \{}
\NormalTok{  data[[col]] }\OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(data[[col]])}
\NormalTok{\}}

\NormalTok{ds\_cor2 }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(}\FunctionTok{subset}\NormalTok{(data, }\AttributeTok{select =}\NormalTok{ ordinal\_variables))}
\FunctionTok{summary}\NormalTok{(ds\_cor2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Inflight_wifi_service Departure_Arrival_time_convenient Ease_of_Online_booking
##  Min.   :0.04385       Min.   :-0.008189                 Min.   :0.008835      
##  1st Qu.:0.12075       1st Qu.: 0.010174                 1st Qu.:0.031817      
##  Median :0.14626       Median : 0.071406                 Median :0.042942      
##  Mean   :0.28596       Mean   : 0.187531                 Mean   :0.240752      
##  3rd Qu.:0.34327       3rd Qu.: 0.281439                 3rd Qu.:0.429509      
##  Max.   :1.00000       Max.   : 1.000000                 Max.   :1.000000      
##  Gate_location       Food_and_drink      Online_boarding     Seat_comfort     
##  Min.   :-0.039294   Min.   :-0.002825   Min.   :0.002579   Min.   :0.002493  
##  1st Qu.:-0.004566   1st Qu.: 0.033765   1st Qu.:0.093460   1st Qu.:0.070338  
##  Median : 0.001795   Median : 0.071289   Median :0.218869   Median :0.126013  
##  Mean   : 0.155209   Mean   : 0.249894   Mean   :0.274452   Mean   :0.286872  
##  3rd Qu.: 0.254598   3rd Qu.: 0.490376   3rd Qu.:0.386041   3rd Qu.:0.536787  
##  Max.   : 1.000000   Max.   : 1.000000   Max.   :1.000000   Max.   :1.000000  
##  Inflight_entertainment On_board_service   Leg_room_service   
##  Min.   :-0.008189      Min.   :-0.02911   Min.   :-0.005146  
##  1st Qu.: 0.141719      1st Qu.: 0.08029   1st Qu.: 0.098644  
##  Median : 0.339932      Median : 0.14246   Median : 0.137932  
##  Mean   : 0.363277      Mean   : 0.26820   Mean   : 0.227516  
##  3rd Qu.: 0.563678      3rd Qu.: 0.40362   3rd Qu.: 0.343551  
##  Max.   : 1.000000      Max.   : 1.00000   Max.   : 1.000000  
##  Baggage_handling   Checkin_service    Inflight_service     Cleanliness       
##  Min.   :0.001097   Min.   :-0.03929   Min.   :0.0003373   Min.   :-0.006066  
##  1st Qu.:0.071638   1st Qu.: 0.08663   1st Qu.:0.0697256   1st Qu.: 0.092118  
##  Median :0.108827   Median : 0.16466   Median :0.1004322   Median : 0.126686  
##  Mean   :0.261266   Mean   : 0.19642   Mean   :0.2630082   Mean   : 0.292360  
##  3rd Qu.:0.377368   3rd Qu.: 0.22710   3rd Qu.:0.3973791   3rd Qu.: 0.575852  
##  Max.   :1.000000   Max.   : 1.00000   Max.   :1.0000000   Max.   : 1.000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{repr.plot.width =} \DecValTok{14}\NormalTok{, }\AttributeTok{repr.plot.height =} \DecValTok{8}\NormalTok{)}
\FunctionTok{corrplot}\NormalTok{(ds\_cor2, }\AttributeTok{na.label=}\StringTok{" "}\NormalTok{, }\AttributeTok{tl.cex=}\DecValTok{1}\NormalTok{, }\AttributeTok{tl.col=}\StringTok{"black"}\NormalTok{, }\AttributeTok{method=}\StringTok{"color"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-28-1.pdf}

\hypertarget{partial-correlation-matrix}{%
\section{PARTIAL CORRELATION MATRIX}\label{partial-correlation-matrix}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numerical\_features }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Age"}\NormalTok{, }\StringTok{"Flight\_Distance"}\NormalTok{, }\StringTok{"Departure\_Delay\_in\_Minutes"}\NormalTok{, }\StringTok{"Arrival\_Delay\_in\_Minutes"}\NormalTok{)}
\NormalTok{partial\_correlations\_num }\OtherTok{\textless{}{-}} \FunctionTok{pcor}\NormalTok{(data[, numerical\_features], }\AttributeTok{method =} \StringTok{"spearman"}\NormalTok{)}

\CommentTok{\# make the matrix}
\NormalTok{partial\_corr\_matrix\_num }\OtherTok{\textless{}{-}}\NormalTok{ partial\_correlations\_num}\SpecialCharTok{$}\NormalTok{estimate}

\CommentTok{\# Customize the plot size}
\FunctionTok{options}\NormalTok{(}\AttributeTok{repr.plot.width =} \DecValTok{200}\NormalTok{, }\AttributeTok{repr.plot.height =} \DecValTok{200}\NormalTok{)}

\CommentTok{\# Create the correlation plot}
\FunctionTok{corrplot}\NormalTok{(partial\_corr\_matrix\_num,}
         \AttributeTok{method =} \StringTok{"color"}\NormalTok{,  }\CommentTok{\# Choose "color" to visualize the correlations using colors}
         \AttributeTok{type =} \StringTok{"upper"}\NormalTok{,    }\CommentTok{\# Only plot the upper triangular part of the matrix (to avoid duplication)}
         \AttributeTok{tl.col =} \StringTok{"black"}\NormalTok{,  }\CommentTok{\# Label color}
         \AttributeTok{tl.cex =} \DecValTok{1}\NormalTok{,        }\CommentTok{\# Label font size}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-29-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#PARTIAL CORRELATION MATRIX FOR CATEGORICAL/ORDINAL}
\NormalTok{categorical\_features }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Inflight\_wifi\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Departure\_Arrival\_time\_convenient\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Ease\_of\_Online\_booking\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Gate\_location\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Food\_and\_drink\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Online\_boarding\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Seat\_comfort\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Inflight\_entertainment\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}On\_board\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Leg\_room\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Baggage\_handling\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Checkin\_service\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Inflight\_service\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cleanliness\textquotesingle{}}\NormalTok{)}
\NormalTok{partial\_correlations\_cat }\OtherTok{\textless{}{-}} \FunctionTok{pcor}\NormalTok{(data[, categorical\_features], }\AttributeTok{method =} \StringTok{"spearman"}\NormalTok{)}

\CommentTok{\# make the matrix}
\NormalTok{partial\_corr\_matrix\_cat }\OtherTok{\textless{}{-}}\NormalTok{ partial\_correlations\_cat}\SpecialCharTok{$}\NormalTok{estimate}

\CommentTok{\# Customize the plot size}
\FunctionTok{options}\NormalTok{(}\AttributeTok{repr.plot.width =} \DecValTok{200}\NormalTok{, }\AttributeTok{repr.plot.height =} \DecValTok{200}\NormalTok{)}

\CommentTok{\# Create the correlation plot}
\FunctionTok{corrplot}\NormalTok{(partial\_corr\_matrix\_cat,}
         \AttributeTok{method =} \StringTok{"color"}\NormalTok{,  }\CommentTok{\# Choose "color" to visualize the correlations using colors}
         \AttributeTok{type =} \StringTok{"upper"}\NormalTok{,    }\CommentTok{\# Only plot the upper triangular part of the matrix (to avoid duplication)}
         \AttributeTok{tl.col =} \StringTok{"black"}\NormalTok{,  }\CommentTok{\# Label color}
         \AttributeTok{tl.cex =} \DecValTok{1}\NormalTok{,        }\CommentTok{\# Label font size}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-29-2.pdf} \#
Convert categorical to numerical

In this section we convert the categorical variables to numeric
representation for modelling.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gender\_map }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Male"} \OtherTok{=} \DecValTok{0}\NormalTok{, }\StringTok{"Female"} \OtherTok{=} \DecValTok{1}\NormalTok{)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Gender }\OtherTok{=}\NormalTok{ gender\_map[}\FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Gender)]}

\NormalTok{customer\_type\_map }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Loyal Customer"} \OtherTok{=} \DecValTok{0}\NormalTok{, }\StringTok{"disloyal Customer"} \OtherTok{=} \DecValTok{1}\NormalTok{)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Customer\_Type }\OtherTok{=}\NormalTok{ customer\_type\_map[}\FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Customer\_Type)]}

\NormalTok{type\_of\_travel\_map }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Personal Travel"} \OtherTok{=} \DecValTok{0}\NormalTok{, }\StringTok{"Business travel"} \OtherTok{=} \DecValTok{1}\NormalTok{)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Type\_of\_Travel }\OtherTok{=}\NormalTok{ type\_of\_travel\_map[}\FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Type\_of\_Travel)]}

\NormalTok{class\_map }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Business"} \OtherTok{=} \DecValTok{0}\NormalTok{, }\StringTok{"Eco"} \OtherTok{=} \DecValTok{1}\NormalTok{, }\StringTok{"Eco Plus"} \OtherTok{=} \DecValTok{2}\NormalTok{)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Class }\OtherTok{=}\NormalTok{ class\_map[}\FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Class)]}

\NormalTok{satisfaction\_map }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"neutral or dissatisfied"} \OtherTok{=} \DecValTok{0}\NormalTok{, }\StringTok{"satisfied"} \OtherTok{=} \DecValTok{1}\NormalTok{)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{satisfaction }\OtherTok{=}\NormalTok{ satisfaction\_map[}\FunctionTok{as.numeric}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{satisfaction)]}

\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ ratings\_fts\_names) \{}
\NormalTok{  data[[col]] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(data[[col]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-preparation}{%
\section{Data Preparation}\label{data-preparation}}

\hypertarget{train-test-split}{%
\subsection{Train test split}\label{train-test-split}}

This section splits the data into training and testing sets, prints the
proportion of satisfied and dissatisfied customers in each set, and
saves the true values of the target variable for the test set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\NormalTok{train\_index }\OtherTok{=} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(data), }\FloatTok{0.8}\SpecialCharTok{*}\FunctionTok{nrow}\NormalTok{(data))}
\CommentTok{\# 80\% of data is used for training}
\NormalTok{train\_data }\OtherTok{=}\NormalTok{ data[train\_index,]}
\CommentTok{\# 20\% of data is used for testing}
\NormalTok{test\_data }\OtherTok{=}\NormalTok{ data[}\SpecialCharTok{{-}}\NormalTok{train\_index,]}
\end{Highlighting}
\end{Shaded}

\hypertarget{features-and-outputs}{%
\subsection{Features and Outputs}\label{features-and-outputs}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Seperate y\_train and y\_test for further use}
\NormalTok{X\_train }\OtherTok{=} \FunctionTok{as.matrix}\NormalTok{(train\_data }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{satisfaction))}
\NormalTok{y\_train }\OtherTok{=}\NormalTok{ train\_data}\SpecialCharTok{$}\NormalTok{satisfaction}

\NormalTok{X\_test }\OtherTok{=} \FunctionTok{as.matrix}\NormalTok{(test\_data }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{satisfaction))}
\NormalTok{y\_test }\OtherTok{=}\NormalTok{ test\_data}\SpecialCharTok{$}\NormalTok{satisfaction}
\end{Highlighting}
\end{Shaded}

\hypertarget{number-of-samples}{%
\subsection{Number of Samples}\label{number-of-samples}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Number of samples in train data}
\NormalTok{train\_rows }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(train\_data)}
\FunctionTok{print}\NormalTok{(train\_rows)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 103589
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Number of samples in test data}
\NormalTok{test\_rows }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(test\_data)}
\FunctionTok{print}\NormalTok{(test\_rows)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 25898
\end{verbatim}

\hypertarget{data-balance}{%
\subsection{Data Balance}\label{data-balance}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Proportion of satisfied and unsatisfied customers for train data}
\FunctionTok{prop.table}\NormalTok{(}\FunctionTok{table}\NormalTok{(y\_train))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## y_train
##         0         1 
## 0.5668845 0.4331155
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Proportion of satisfied and unsatisfied customers for test data}
\FunctionTok{prop.table}\NormalTok{(}\FunctionTok{table}\NormalTok{(y\_test))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## y_test
##        0        1 
## 0.559966 0.440034
\end{verbatim}

As we can see the proportion of binary classes in train and test are
similar. We can say that our test data is representative of train data.

In this project we want to find unsatisfied customers (class 0). We
hypothesis that if we find the unsatisfied customers, then we arrange
our customer satisfaction campaign accordingly.

\hypertarget{classification-models}{%
\section{Classification Models}\label{classification-models}}

Classification, a form of supervised learning, involves predicting the
qualitative response of an observation by assigning it to a specific
category or class. Multivariate techniques excel in constructing
prediction models, forming the foundation of statistical classification.
In the realm of machine learning, this process is referred to as
supervised learning.

To build a classifier, we utilize a set of training observations. From a
geometric perspective, an allocation rule determines how the input space
is divided into regions, each labeled according to its classification.
The boundaries of these regions can vary based on the assumptions made
when constructing the classification model.

\hypertarget{logistic-regression}{%
\subsection{Logistic Regression}\label{logistic-regression}}

In logistic model observations are assumed to be realizations of
independent Bernoulli random variables. It is like if a customer will be
satisfied with flight or not.

\hypertarget{basic-logistic-classifier}{%
\subsubsection{Basic Logistic
Classifier}\label{basic-logistic-classifier}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Model definition with all features:}
\NormalTok{glm\_full}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\CommentTok{\# summary of full model}
\FunctionTok{summary}\NormalTok{(glm\_full)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = satisfaction ~ ., family = "binomial", data = train_data)
## 
## Coefficients:
##                                     Estimate Std. Error  z value Pr(>|z|)    
## (Intercept)                       -1.009e+01  9.391e-02 -107.446  < 2e-16 ***
## Gender                             6.254e-02  1.947e-02    3.212  0.00132 ** 
## Customer_Type                      2.097e+00  2.952e-02   71.047  < 2e-16 ***
## Age                               -8.023e-03  7.113e-04  -11.279  < 2e-16 ***
## Type_of_Travel                    -2.847e+00  3.006e-02  -94.735  < 2e-16 ***
## Class                             -5.084e-01  1.903e-02  -26.717  < 2e-16 ***
## Flight_Distance                   -4.382e-06  1.123e-05   -0.390  0.69637    
## Inflight_wifi_service              4.003e-01  1.150e-02   34.797  < 2e-16 ***
## Departure_Arrival_time_convenient -1.308e-01  8.157e-03  -16.034  < 2e-16 ***
## Ease_of_Online_booking            -1.567e-01  1.135e-02  -13.804  < 2e-16 ***
## Gate_location                      2.172e-02  9.170e-03    2.369  0.01785 *  
## Food_and_drink                    -2.931e-02  1.072e-02   -2.734  0.00626 ** 
## Online_boarding                    6.238e-01  1.029e-02   60.605  < 2e-16 ***
## Seat_comfort                       5.770e-02  1.121e-02    5.148 2.63e-07 ***
## Inflight_entertainment             5.297e-02  1.424e-02    3.719  0.00020 ***
## On_board_service                   3.075e-01  1.015e-02   30.294  < 2e-16 ***
## Leg_room_service                   2.533e-01  8.525e-03   29.710  < 2e-16 ***
## Baggage_handling                   1.359e-01  1.139e-02   11.924  < 2e-16 ***
## Checkin_service                    3.290e-01  8.554e-03   38.455  < 2e-16 ***
## Inflight_service                   1.270e-01  1.201e-02   10.575  < 2e-16 ***
## Cleanliness                        2.323e-01  1.214e-02   19.140  < 2e-16 ***
## Departure_Delay_in_Minutes         4.940e-03  9.854e-04    5.014 5.34e-07 ***
## Arrival_Delay_in_Minutes          -9.763e-03  9.735e-04  -10.029  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 141746  on 103588  degrees of freedom
## Residual deviance:  69319  on 103566  degrees of freedom
## AIC: 69365
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

As we can see from model statistics, the p value of ``flight distance''
feature is not lower than 0.5 which indicates that the effect of
``flight distance'' on prediction of satisfaction is insignificant.
However, we would like to keep all features in the model for now. Then
we will full model with feature selection models.

In the code snippet below, we can observe the calculation goodness of
fit, also known as R-squared (R²). R² serves as a metric to assess how
well the GLM (Generalized Linear Model) model aligns with the given data
in comparison to a null model, which solely consists of an intercept
without any predictors. The R² value is derived using a simple formula:
1 minus the ratio of the deviance of the fitted model to the deviance of
the null model.

R² value provides insights into the amount of variation in the data that
can be accounted for by the model, thus serving as a measure of its
effectiveness.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r2}\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (}\FunctionTok{summary}\NormalTok{(glm\_full)}\SpecialCharTok{$}\NormalTok{deviance}\SpecialCharTok{/}\FunctionTok{summary}\NormalTok{(glm\_full)}\SpecialCharTok{$}\NormalTok{null.deviance)}
\NormalTok{r2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5109608
\end{verbatim}

In the provided line of code, the calculation of the variance inflation
factor (VIF) is performed by taking the reciprocal of 1 minus the R²
value. The VIF serves as a metric to evaluate the presence of
multicollinearity, which refers to the correlation between predictor
variables within a model. High levels of multicollinearity can introduce
issues regarding the reliability and interpretability of the GLM
(Generalized Linear Model).

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{r2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.044826
\end{verbatim}

\hypertarget{logistic-regression-with-backward-variable-selection}{%
\subsubsection{Logistic Regression with Backward Variable
Selection}\label{logistic-regression-with-backward-variable-selection}}

Collinearity refers to a situation where two or more predictor variables
in a statistical model are closely related to each other. The presence
of collinearity can introduce instability to the model and make it more
challenging to accurately estimate the effect of each predictor
variable.

Ideally, we aim for low collinearity among predictor variables. When
collinearity is low, it implies that the predictor variables are
independent or weakly correlated, allowing for more reliable estimation
of their individual effects on the model.

The Variance Inflation Factor (VIF) is a measure used to assess
collinearity among predictor variables within a multiple regression
model. It is computed by taking the ratio of the variance of all the
weights in the model divided by the variance of a single weight if that
particular predictor variable were fitted alone.

A VIF of 1 indicates no collinearity, while a VIF between 1 and 5
suggests moderate collinearity. On the other hand, a VIF greater than 5
indicates high collinearity, which is undesirable and should be avoided.

To address high collinearity, we may choose to remove certain predictor
variables from the model and observe the impact on the corresponding
R-squared value. By iteratively adjusting the predictor variables, we
can determine a suitable set of variables that minimize collinearity and
yield a more robust model.

Variable selection is crucial in regression models to ensure
interpretability, computational efficiency, and generalization. It
involves removing irrelevant variables, reducing redundancy, and
combating overfitting. By choosing relevant variables, the model becomes
easier to interpret, algorithms work faster with high-dimensional data,
and overfitting is reduced. The focus is on low test error rather than
training error. Variable selection is especially important for
high-dimensional datasets with more features than observations. Here, we
are gonna use backward selection starting from full model and reducing
number of variables in order of high VIF factor to lower VIF factors to
decrease multi-collinearity and increase robustness of model.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VIF Iteration 0}
\CommentTok{\# The process is done iteratively where we delete one variable at time}
\NormalTok{vif\_values }\OtherTok{\textless{}{-}} \FunctionTok{VIF}\NormalTok{(glm\_full)}

\CommentTok{\# Create a data frame with variable names and their corresponding VIF values}
\NormalTok{vif\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{names}\NormalTok{(vif\_values), }\AttributeTok{VIF =}\NormalTok{ vif\_values,}\AttributeTok{row.names =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Sort the data frame in decreasing order of VIF values}
\NormalTok{sorted\_df }\OtherTok{\textless{}{-}}\NormalTok{ vif\_df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{vif\_df}\SpecialCharTok{$}\NormalTok{VIF), ]}
\FunctionTok{rownames}\NormalTok{(sorted\_df) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# Print the sorted data frame}
\FunctionTok{print}\NormalTok{(sorted\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                             Variable       VIF
## 1           Arrival_Delay_in_Minutes 14.215472
## 2         Departure_Delay_in_Minutes 14.179745
## 3             Inflight_entertainment  3.259516
## 4             Ease_of_Online_booking  2.605648
## 5                        Cleanliness  2.477654
## 6              Inflight_wifi_service  2.234296
## 7                       Seat_comfort  2.056168
## 8                     Food_and_drink  2.028994
## 9                   Inflight_service  2.003726
## 10                  Baggage_handling  1.815847
## 11 Departure_Arrival_time_convenient  1.710988
## 12                    Type_of_Travel  1.701605
## 13                  On_board_service  1.630928
## 14                     Customer_Type  1.586551
## 15                     Gate_location  1.521229
## 16                   Online_boarding  1.493912
## 17                             Class  1.456328
## 18                   Flight_Distance  1.336138
## 19                  Leg_room_service  1.218179
## 20                   Checkin_service  1.208464
## 21                               Age  1.183984
## 22                            Gender  1.007103
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VIF Iteration 1}
\CommentTok{\# The process is done iteratively where we delete one variable at time}
\CommentTok{\# Model definition:}
\NormalTok{glm\_vif1}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}\SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\NormalTok{vif\_values }\OtherTok{\textless{}{-}} \FunctionTok{VIF}\NormalTok{(glm\_vif1)}

\CommentTok{\# Create a data frame with variable names and their corresponding VIF values}
\NormalTok{vif\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{names}\NormalTok{(vif\_values), }\AttributeTok{VIF =}\NormalTok{ vif\_values,}\AttributeTok{row.names =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Sort the data frame in decreasing order of VIF values}
\NormalTok{sorted\_df }\OtherTok{\textless{}{-}}\NormalTok{ vif\_df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{vif\_df}\SpecialCharTok{$}\NormalTok{VIF), ]}
\FunctionTok{rownames}\NormalTok{(sorted\_df) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# Print the sorted data frame}
\FunctionTok{print}\NormalTok{(sorted\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                             Variable      VIF
## 1             Inflight_entertainment 3.255757
## 2             Ease_of_Online_booking 2.605184
## 3                        Cleanliness 2.473880
## 4              Inflight_wifi_service 2.233429
## 5                       Seat_comfort 2.055698
## 6                     Food_and_drink 2.024997
## 7                   Inflight_service 2.002608
## 8                   Baggage_handling 1.816225
## 9  Departure_Arrival_time_convenient 1.712667
## 10                    Type_of_Travel 1.699870
## 11                  On_board_service 1.631063
## 12                     Customer_Type 1.584320
## 13                     Gate_location 1.521679
## 14                   Online_boarding 1.492315
## 15                             Class 1.456741
## 16                   Flight_Distance 1.336573
## 17                  Leg_room_service 1.218233
## 18                   Checkin_service 1.208269
## 19                               Age 1.183542
## 20        Departure_Delay_in_Minutes 1.019193
## 21                            Gender 1.007146
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VIF Iteration 2}
\CommentTok{\# The process is done iteratively where we delete one variable at time}
\CommentTok{\# Model definition:}
\NormalTok{glm\_vif2}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}
               \SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes}
               \SpecialCharTok{{-}}\NormalTok{Inflight\_entertainment,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\NormalTok{vif\_values }\OtherTok{\textless{}{-}} \FunctionTok{VIF}\NormalTok{(glm\_vif2)}

\CommentTok{\# Create a data frame with variable names and their corresponding VIF values}
\NormalTok{vif\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{names}\NormalTok{(vif\_values), }\AttributeTok{VIF =}\NormalTok{ vif\_values,}\AttributeTok{row.names =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Sort the data frame in decreasing order of VIF values}
\NormalTok{sorted\_df }\OtherTok{\textless{}{-}}\NormalTok{ vif\_df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{vif\_df}\SpecialCharTok{$}\NormalTok{VIF), ]}
\FunctionTok{rownames}\NormalTok{(sorted\_df) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# Print the sorted data frame}
\FunctionTok{print}\NormalTok{(sorted\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                             Variable      VIF
## 1             Ease_of_Online_booking 2.598560
## 2              Inflight_wifi_service 2.186179
## 3                        Cleanliness 2.077800
## 4                       Seat_comfort 1.926523
## 5                   Inflight_service 1.865661
## 6                   Baggage_handling 1.774342
## 7                     Food_and_drink 1.756367
## 8  Departure_Arrival_time_convenient 1.709160
## 9                     Type_of_Travel 1.669340
## 10                     Customer_Type 1.540963
## 11                  On_board_service 1.526698
## 12                     Gate_location 1.521864
## 13                   Online_boarding 1.474095
## 14                             Class 1.447649
## 15                   Flight_Distance 1.336219
## 16                  Leg_room_service 1.203120
## 17                               Age 1.179147
## 18                   Checkin_service 1.167757
## 19        Departure_Delay_in_Minutes 1.017485
## 20                            Gender 1.005707
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VIF Iteration 3}
\CommentTok{\# The process is done iteratively where we delete one variable at time}
\CommentTok{\# Model definition:}
\NormalTok{glm\_vif3}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}
                \SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes}
                \SpecialCharTok{{-}}\NormalTok{Inflight\_entertainment}
                \SpecialCharTok{{-}}\NormalTok{Ease\_of\_Online\_booking ,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\NormalTok{vif\_values }\OtherTok{\textless{}{-}} \FunctionTok{VIF}\NormalTok{(glm\_vif3)}

\CommentTok{\# Create a data frame with variable names and their corresponding VIF values}
\NormalTok{vif\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{names}\NormalTok{(vif\_values), }\AttributeTok{VIF =}\NormalTok{ vif\_values,}\AttributeTok{row.names =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Sort the data frame in decreasing order of VIF values}
\NormalTok{sorted\_df }\OtherTok{\textless{}{-}}\NormalTok{ vif\_df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{vif\_df}\SpecialCharTok{$}\NormalTok{VIF), ]}
\FunctionTok{rownames}\NormalTok{(sorted\_df) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# Print the sorted data frame}
\FunctionTok{print}\NormalTok{(sorted\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                             Variable      VIF
## 1                        Cleanliness 2.065788
## 2                       Seat_comfort 1.912316
## 3                   Inflight_service 1.866483
## 4                   Baggage_handling 1.775338
## 5                     Food_and_drink 1.753620
## 6                     Type_of_Travel 1.647770
## 7  Departure_Arrival_time_convenient 1.579042
## 8              Inflight_wifi_service 1.550964
## 9                   On_board_service 1.526237
## 10                     Customer_Type 1.519908
## 11                             Class 1.439914
## 12                   Online_boarding 1.414436
## 13                     Gate_location 1.391271
## 14                   Flight_Distance 1.335326
## 15                  Leg_room_service 1.198439
## 16                               Age 1.172301
## 17                   Checkin_service 1.166160
## 18        Departure_Delay_in_Minutes 1.016243
## 19                            Gender 1.005019
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VIF Iteration 4}
\CommentTok{\# The process is done iteratively where we delete one variable at time}
\CommentTok{\# Model definition:}
\NormalTok{glm\_vif4}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}
               \SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes}
               \SpecialCharTok{{-}}\NormalTok{Inflight\_entertainment}
               \SpecialCharTok{{-}}\NormalTok{Ease\_of\_Online\_booking }
               \SpecialCharTok{{-}}\NormalTok{Cleanliness ,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\NormalTok{vif\_values }\OtherTok{\textless{}{-}} \FunctionTok{VIF}\NormalTok{(glm\_vif4)}

\CommentTok{\# Create a data frame with variable names and their corresponding VIF values}
\NormalTok{vif\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{names}\NormalTok{(vif\_values), }\AttributeTok{VIF =}\NormalTok{ vif\_values,}\AttributeTok{row.names =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Sort the data frame in decreasing order of VIF values}
\NormalTok{sorted\_df }\OtherTok{\textless{}{-}}\NormalTok{ vif\_df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{vif\_df}\SpecialCharTok{$}\NormalTok{VIF), ]}
\FunctionTok{rownames}\NormalTok{(sorted\_df) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# Print the sorted data frame}
\FunctionTok{print}\NormalTok{(sorted\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                             Variable      VIF
## 1                   Inflight_service 1.876230
## 2                   Baggage_handling 1.785063
## 3                     Type_of_Travel 1.638313
## 4                       Seat_comfort 1.589209
## 5  Departure_Arrival_time_convenient 1.583651
## 6              Inflight_wifi_service 1.552265
## 7                   On_board_service 1.532209
## 8                      Customer_Type 1.511725
## 9                              Class 1.437882
## 10                    Food_and_drink 1.436115
## 11                   Online_boarding 1.409432
## 12                     Gate_location 1.399444
## 13                   Flight_Distance 1.335607
## 14                  Leg_room_service 1.202751
## 15                               Age 1.169812
## 16                   Checkin_service 1.163605
## 17        Departure_Delay_in_Minutes 1.013200
## 18                            Gender 1.004492
\end{verbatim}

We deleted all the features with VIF greater than 2 to decrease
multicollinearity. Let's check the current model statistics.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{glm\_reduced}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}
                \SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes}
                \SpecialCharTok{{-}}\NormalTok{Inflight\_entertainment}
                \SpecialCharTok{{-}}\NormalTok{Ease\_of\_Online\_booking }
                \SpecialCharTok{{-}}\NormalTok{Cleanliness    ,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}
\CommentTok{\# Observation of the model summary:}
\FunctionTok{summary}\NormalTok{(glm\_reduced)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = satisfaction ~ . - Arrival_Delay_in_Minutes - Inflight_entertainment - 
##     Ease_of_Online_booking - Cleanliness, family = "binomial", 
##     data = train_data)
## 
## Coefficients:
##                                     Estimate Std. Error  z value Pr(>|z|)    
## (Intercept)                       -1.019e+01  9.050e-02 -112.653  < 2e-16 ***
## Gender                             6.586e-02  1.928e-02    3.415 0.000637 ***
## Customer_Type                      2.125e+00  2.894e-02   73.426  < 2e-16 ***
## Age                               -8.147e-03  7.027e-04  -11.595  < 2e-16 ***
## Type_of_Travel                    -2.850e+00  2.952e-02  -96.543  < 2e-16 ***
## Class                             -4.662e-01  1.866e-02  -24.977  < 2e-16 ***
## Flight_Distance                   -4.647e-06  1.110e-05   -0.419 0.675402    
## Inflight_wifi_service              3.193e-01  9.487e-03   33.657  < 2e-16 ***
## Departure_Arrival_time_convenient -1.661e-01  7.799e-03  -21.303  < 2e-16 ***
## Gate_location                     -1.518e-02  8.700e-03   -1.745 0.080960 .  
## Food_and_drink                     8.647e-02  8.923e-03    9.691  < 2e-16 ***
## Online_boarding                    6.119e-01  9.991e-03   61.239  < 2e-16 ***
## Seat_comfort                       1.868e-01  9.779e-03   19.099  < 2e-16 ***
## On_board_service                   3.223e-01  9.728e-03   33.130  < 2e-16 ***
## Leg_room_service                   2.524e-01  8.399e-03   30.056  < 2e-16 ***
## Baggage_handling                   1.543e-01  1.115e-02   13.839  < 2e-16 ***
## Checkin_service                    3.337e-01  8.313e-03   40.142  < 2e-16 ***
## Inflight_service                   1.480e-01  1.147e-02   12.907  < 2e-16 ***
## Departure_Delay_in_Minutes        -4.332e-03  2.620e-04  -16.538  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 141746  on 103588  degrees of freedom
## Residual deviance:  70189  on 103570  degrees of freedom
## AIC: 70227
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

``Flight\_Distance'' and ``Gate\_location'' features are insignificant
in prediction of satisfaction. Let's drop them from model.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Drop Flight\_Distance and Gate\_location from model.}

\NormalTok{glm\_backward}\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ train\_data,}
\NormalTok{                satisfaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .}
                \SpecialCharTok{{-}}\NormalTok{Arrival\_Delay\_in\_Minutes}
                \SpecialCharTok{{-}}\NormalTok{Inflight\_entertainment}
                \SpecialCharTok{{-}}\NormalTok{Ease\_of\_Online\_booking }
                \SpecialCharTok{{-}}\NormalTok{Cleanliness}
                \SpecialCharTok{{-}}\NormalTok{Flight\_Distance}
                \SpecialCharTok{{-}}\NormalTok{Gate\_location,}
                \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{)}

\FunctionTok{summary}\NormalTok{(glm\_backward)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = satisfaction ~ . - Arrival_Delay_in_Minutes - Inflight_entertainment - 
##     Ease_of_Online_booking - Cleanliness - Flight_Distance - 
##     Gate_location, family = "binomial", data = train_data)
## 
## Coefficients:
##                                     Estimate Std. Error  z value Pr(>|z|)    
## (Intercept)                       -1.024e+01  8.602e-02 -119.103  < 2e-16 ***
## Gender                             6.591e-02  1.928e-02    3.418  0.00063 ***
## Customer_Type                      2.124e+00  2.777e-02   76.477  < 2e-16 ***
## Age                               -8.133e-03  7.012e-04  -11.599  < 2e-16 ***
## Type_of_Travel                    -2.843e+00  2.900e-02  -98.031  < 2e-16 ***
## Class                             -4.629e-01  1.762e-02  -26.269  < 2e-16 ***
## Inflight_wifi_service              3.166e-01  9.320e-03   33.971  < 2e-16 ***
## Departure_Arrival_time_convenient -1.723e-01  6.973e-03  -24.705  < 2e-16 ***
## Food_and_drink                     8.683e-02  8.920e-03    9.734  < 2e-16 ***
## Online_boarding                    6.142e-01  9.880e-03   62.172  < 2e-16 ***
## Seat_comfort                       1.859e-01  9.766e-03   19.035  < 2e-16 ***
## On_board_service                   3.228e-01  9.719e-03   33.209  < 2e-16 ***
## Leg_room_service                   2.527e-01  8.388e-03   30.131  < 2e-16 ***
## Baggage_handling                   1.550e-01  1.114e-02   13.906  < 2e-16 ***
## Checkin_service                    3.341e-01  8.307e-03   40.216  < 2e-16 ***
## Inflight_service                   1.485e-01  1.146e-02   12.953  < 2e-16 ***
## Departure_Delay_in_Minutes        -4.336e-03  2.619e-04  -16.555  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 141746  on 103588  degrees of freedom
## Residual deviance:  70192  on 103572  degrees of freedom
## AIC: 70226
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

Interestingly, model with backward elimination variable selection has
less R² value than full model. We will discuss the reason at the end of
Logistic Regression part.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r2}\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (}\FunctionTok{summary}\NormalTok{(glm\_backward)}\SpecialCharTok{$}\NormalTok{deviance}\SpecialCharTok{/}\FunctionTok{summary}\NormalTok{(glm\_backward)}\SpecialCharTok{$}\NormalTok{null.deviance)}
\NormalTok{r2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5047998
\end{verbatim}

\hypertarget{logistic-regression-with-shrinkage-method}{%
\subsubsection{Logistic Regression with Shrinkage
Method}\label{logistic-regression-with-shrinkage-method}}

Shrinkage methods, such as Ridge and Lasso regression, are techniques
used in linear modeling to control model complexity and reduce
overfitting. Instead of selecting a subset of predictors or setting some
coefficients to zero, these methods constrain or regularize the
coefficient estimates, effectively shrinking them towards zero. Ridge
regression achieves this by using quadratic shrinking, while Lasso
regression uses absolute-value shrinking. Other hybrid approaches, like
the elastic net, combine elements of both methods.

One disadvantage of ridge regression is that it includes all predictors
in the final model, unlike subset selection methods which typically
select a subset of variables. To overcome this drawback, the lasso
regression is used as an alternative. The lasso also shrinks the
coefficient estimates towards zero, and it tends to perform better.

Lambda is the Tuning Parameter that controls the bias-variance tradeoff
and we estimate its best value via cross-validation.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# We look for the best value for lambda}
\CommentTok{\# We use cross validation glmnet}
\NormalTok{glm\_lasso }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(X\_train, }\FunctionTok{as.factor}\NormalTok{(y\_train),}
                      \AttributeTok{alpha =} \DecValTok{0}\NormalTok{, }\AttributeTok{family =} \StringTok{"binomial"}\NormalTok{, }\AttributeTok{type.measure =} \StringTok{"class"}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(glm\_lasso)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-46-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# We identify th best lambda value}
\NormalTok{best\_lambda }\OtherTok{\textless{}{-}}\NormalTok{ glm\_lasso}\SpecialCharTok{$}\NormalTok{lambda.min}
\NormalTok{best\_lambda}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.02491896
\end{verbatim}

\hypertarget{roc-curve}{%
\subsubsection{ROC Curve}\label{roc-curve}}

We created our 3 different logistic regression model. Now, it is time to
compare them on test sets to see their robustness on generalization and
power on predicting satisfaction of customer.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Full model}
\CommentTok{\# Computing the predictions with the model on the test set:}
\NormalTok{pred\_glm\_full}\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(glm\_full, }\FunctionTok{data.frame}\NormalTok{(X\_test), }\AttributeTok{type =} \StringTok{"response"}\NormalTok{)}

\CommentTok{\# Backward elimination selection}
\CommentTok{\# Computing the predictions with the model on the test set:}
\NormalTok{pred\_glm\_backward}\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(glm\_backward, }\FunctionTok{data.frame}\NormalTok{(X\_test), }\AttributeTok{type =} \StringTok{"response"}\NormalTok{)}

\CommentTok{\# Lasso regresssion}
\CommentTok{\# Computing the predictions with the model on the test set:}
\NormalTok{pred\_glm\_lasso}\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(glm\_lasso, X\_test, }\AttributeTok{type=} \StringTok{"response"}\NormalTok{, }\AttributeTok{s =}\NormalTok{ best\_lambda)}
\end{Highlighting}
\end{Shaded}

The Receiver Operating Characteristics (ROC) curve illustrates the
relationship between the True positive rate and the False positive rate
across various thresholds. In an ideal scenario, the ROC curve would
closely follow the top left corner. The overall effectiveness of a
classifier, considering all thresholds, is quantified by the Area Under
the Curve (AUC). A larger AUC value indicates a superior classifier
performance.

\begin{verbatim}
## 
## Call:
## roc.default(response = y_test, predictor = pred_glm_full, percent = TRUE,     quiet = TRUE, plot = TRUE, legacy.axes = TRUE, xlab = "False Positive Percentage",     ylab = "True Positive Percentage", col = "blue", lwd = 4,     print.auc = TRUE, print.auc.y = 60, print.auc.x = 30)
## 
## Data: pred_glm_full in 14502 controls (y_test 0) < 11396 cases (y_test 1).
## Area under the curve: 92.56%
\end{verbatim}

\begin{verbatim}
## Warning in roc.default(x, predictor, plot = TRUE, ...): Deprecated use a matrix
## as predictor. Unexpected results may be produced, please pass a numeric vector.
\end{verbatim}

\includegraphics{Report_files/figure-latex/roc-1.pdf}

Ideally, we expect backward and lasso model to have better
generaliation; however, in this scenario, the results yield opposite
situation.

\hypertarget{comparison-of-logistic-classifiers}{%
\subsubsection{Comparison of Logistic
Classifiers}\label{comparison-of-logistic-classifiers}}

We have 3 different Logistic Regression models 1- Basic Logistic
Classifier : glm\_full 2- Logistic Regression with Backward Variable
Selection: glm\_backward 3- Logistic Regression with Lasso Shrinkage:
glm\_lasso

Now, it is time to make predictions and compare metric results. But,
first we should decide best thresholds for models.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# This function will return evaluation metrics}
\NormalTok{calculate\_evaluation\_metrics }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(thresholds, output\_list, y\_test) \{}
  \CommentTok{\# Create an empty data frame to store the results}
\NormalTok{  results\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{Threshold =} \FunctionTok{numeric}\NormalTok{(}\FunctionTok{length}\NormalTok{(thresholds)),}
    \AttributeTok{Accuracy =} \FunctionTok{numeric}\NormalTok{(}\FunctionTok{length}\NormalTok{(thresholds)),}
    \AttributeTok{F1\_Score =} \FunctionTok{numeric}\NormalTok{(}\FunctionTok{length}\NormalTok{(thresholds)),}
    \AttributeTok{Precision =} \FunctionTok{numeric}\NormalTok{(}\FunctionTok{length}\NormalTok{(thresholds)),}
    \AttributeTok{Recall =} \FunctionTok{numeric}\NormalTok{(}\FunctionTok{length}\NormalTok{(thresholds))}
\NormalTok{  )}
  
  \CommentTok{\# Calculate evaluation metrics for each threshold }
  \CommentTok{\# Store the results in the data frame}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(thresholds)) \{}
\NormalTok{    threshold }\OtherTok{\textless{}{-}}\NormalTok{ thresholds[i]}
    
\NormalTok{    pred\_output }\OtherTok{\textless{}{-}}\NormalTok{ output\_list[[}\FunctionTok{as.character}\NormalTok{(threshold)]]}
    
\NormalTok{    results\_df[i, }\StringTok{"Threshold"}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ threshold}
\NormalTok{    results\_df[i, }\StringTok{"Accuracy"}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{Accuracy}\NormalTok{(}\AttributeTok{y\_pred =}\NormalTok{ pred\_output, }\AttributeTok{y\_true =}\NormalTok{ y\_test)}
\NormalTok{    results\_df[i, }\StringTok{"F1\_Score"}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{F1\_Score}\NormalTok{(}\AttributeTok{y\_pred =}\NormalTok{ pred\_output, }\AttributeTok{y\_true =}\NormalTok{ y\_test)}
\NormalTok{    results\_df[i, }\StringTok{"Precision"}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{Precision}\NormalTok{(}\AttributeTok{y\_pred =}\NormalTok{ pred\_output, }\AttributeTok{y\_true =}\NormalTok{ y\_test)}
\NormalTok{    results\_df[i, }\StringTok{"Recall"}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{Recall}\NormalTok{(}\AttributeTok{y\_pred =}\NormalTok{ pred\_output, }\AttributeTok{y\_true =}\NormalTok{ y\_test)}
\NormalTok{  \}}
  
  \CommentTok{\# Format the floating{-}point numbers with two decimal places}
\NormalTok{  results\_df}\SpecialCharTok{$}\NormalTok{Accuracy }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(results\_df}\SpecialCharTok{$}\NormalTok{Accuracy, }\DecValTok{4}\NormalTok{)}
\NormalTok{  results\_df}\SpecialCharTok{$}\NormalTok{F1\_Score }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(results\_df}\SpecialCharTok{$}\NormalTok{F1\_Score, }\DecValTok{4}\NormalTok{)}
\NormalTok{  results\_df}\SpecialCharTok{$}\NormalTok{Precision }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(results\_df}\SpecialCharTok{$}\NormalTok{Precision, }\DecValTok{4}\NormalTok{)}
\NormalTok{  results\_df}\SpecialCharTok{$}\NormalTok{Recall }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(results\_df}\SpecialCharTok{$}\NormalTok{Recall, }\DecValTok{4}\NormalTok{)}
  
  \FunctionTok{return}\NormalTok{(results\_df)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{evaluate\_on\_thresholds }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(predictions,y\_test, thresholds) \{}
  \CommentTok{\# Converting the prediction in \{0,1\} according to the chosen threshold:}
\NormalTok{  output\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
  
  \ControlFlowTok{for}\NormalTok{ (threshold }\ControlFlowTok{in}\NormalTok{ thresholds) \{}
\NormalTok{    output }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(predictions }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{    output\_list[[}\FunctionTok{as.character}\NormalTok{(threshold)]] }\OtherTok{\textless{}{-}}\NormalTok{ output}
\NormalTok{  \}}
  
  \CommentTok{\# Access the outputs using the threshold values as keys}
  \CommentTok{\#output\_list$\textasciigrave{}0.4\textasciigrave{}}
  \CommentTok{\#output\_list$\textasciigrave{}0.5\textasciigrave{}}
  \CommentTok{\#output\_list$\textasciigrave{}0.6\textasciigrave{}}
  \CommentTok{\#output\_list$\textasciigrave{}0.7\textasciigrave{}}
  
  
  \CommentTok{\# Calculate evaluation metrics}
\NormalTok{  results }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_evaluation\_metrics}\NormalTok{(thresholds, output\_list, y\_test)}
  
  \CommentTok{\# Print the results as a table in R Markdown}
\NormalTok{  knitr}\SpecialCharTok{::}\FunctionTok{kable}\NormalTok{(results, }\AttributeTok{align =} \StringTok{"c"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{thresholds }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.4}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.6}\NormalTok{, }\FloatTok{0.7}\NormalTok{)}
\FunctionTok{evaluate\_on\_thresholds}\NormalTok{(pred\_glm\_full, y\_test, thresholds)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ccccc@{}}
\toprule\noalign{}
Threshold & Accuracy & F1\_Score & Precision & Recall \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0.4 & 0.8614 & 0.8739 & 0.8907 & 0.8577 \\
0.5 & 0.8725 & 0.8880 & 0.8738 & 0.9028 \\
0.6 & 0.8735 & 0.8925 & 0.8519 & 0.9370 \\
0.7 & 0.8633 & 0.8874 & 0.8236 & 0.9619 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{thresholds }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.4}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.6}\NormalTok{, }\FloatTok{0.7}\NormalTok{)}
\FunctionTok{evaluate\_on\_thresholds}\NormalTok{(pred\_glm\_backward, y\_test, thresholds)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ccccc@{}}
\toprule\noalign{}
Threshold & Accuracy & F1\_Score & Precision & Recall \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0.4 & 0.8589 & 0.8715 & 0.8893 & 0.8544 \\
0.5 & 0.8714 & 0.8870 & 0.8730 & 0.9015 \\
0.6 & 0.8734 & 0.8924 & 0.8515 & 0.9375 \\
0.7 & 0.8628 & 0.8871 & 0.8227 & 0.9624 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{thresholds }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.4}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.6}\NormalTok{, }\FloatTok{0.7}\NormalTok{)}
\FunctionTok{evaluate\_on\_thresholds}\NormalTok{(pred\_glm\_lasso, y\_test, thresholds)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ccccc@{}}
\toprule\noalign{}
Threshold & Accuracy & F1\_Score & Precision & Recall \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0.4 & 0.8565 & 0.8689 & 0.8896 & 0.8492 \\
0.5 & 0.8710 & 0.8872 & 0.8694 & 0.9058 \\
0.6 & 0.8708 & 0.8914 & 0.8419 & 0.9470 \\
0.7 & 0.8536 & 0.8815 & 0.8058 & 0.9730 \\
\end{longtable}

All 3 logistic regression models have highest F1 score with 0.6
threshold. Eventhough the expectation that backward variable selection
and lasso regression model would suprass full\_model, the results shows
opposite. F1 score with 0.6 threshold for glm\_full is higher than other
models on the test set. We can conclude that generalizability of full
model is higher. We may conclude that we have many samples but we do not
have enough features to increase model generalizability, so decreasing
number of variables or shrinking their weights do not make positive
effect. We take pred\_glm\_full as a winner prediction from logistic
regression part to further compare it with other models.

\hypertarget{naive-bayes}{%
\subsection{Naive Bayes}\label{naive-bayes}}

The Naive Bayes Classifier is a probabilistic algorithm used for binary
classification. It assumes that features are independent of each other
and calculates prior probabilities and likelihoods during the training
phase. The prior probabilities represent the occurrence of each class,
while the likelihoods determine the probability of a feature given a
class. By applying Bayes' theorem, the algorithm calculates posterior
probabilities for each class and assigns the instance to the class with
the highest probability.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nb.fit }\OtherTok{\textless{}{-}} \FunctionTok{naiveBayes}\NormalTok{(}\AttributeTok{data =} \FunctionTok{data.frame}\NormalTok{(X\_train),}
\NormalTok{                     y\_train }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .)}

\CommentTok{\# Make predictions on the test data}
\NormalTok{pred\_naive\_bayes }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(nb.fit, }\AttributeTok{newdata =}\NormalTok{ X\_test)}

\CommentTok{\# Evaluate accuracy of classifier}
\FunctionTok{mean}\NormalTok{(pred\_naive\_bayes }\SpecialCharTok{==}\NormalTok{ y\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8647
\end{verbatim}

BIC (Bayesian Information Criterion) is a commonly used model selection
criteria that help in selecting the best model among a set of competing
models. It takes into account the goodness of fit of the model and
penalize the complexity of the model to avoid overfitting.

BIC (Bayesian Information Criterion): It balances the trade-off between
model fit and model complexity. Formula: BIC = -2 * log-likelihood + p *
log(n)

\begin{itemize}
\tightlist
\item
  log-likelihood: The log-likelihood of the model, which measures how
  well the model fits the data.
\item
  p: The number of parameters in the model.
\item
  n: The sample size.
\end{itemize}

BIC penalizes model complexity more heavily than the Akaike Information
Criterion (AIC). The lower the BIC value, the better the model is
considered to be. Therefore, when comparing models, the model with the
lowest BIC is preferred.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Best Subset Selection}

\CommentTok{\# The regsubsets() function (part of the leaps library) }
\CommentTok{\# performs best subset selection by identifying the best }
\CommentTok{\# model that contains a given number of predictors, }
\CommentTok{\# where best is quantified using bic}

\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(X\_train)[}\DecValTok{1}\NormalTok{]}
\NormalTok{regfit.full }\OtherTok{\textless{}{-}} \FunctionTok{regsubsets}\NormalTok{(y\_train}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data=}\FunctionTok{data.frame}\NormalTok{(X\_train),}\AttributeTok{nvmax=}\NormalTok{n)}
\NormalTok{reg.summary }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(regfit.full)}

\CommentTok{\# Plotting BIC }
\CommentTok{\# BIC with its smallest value}
\FunctionTok{plot}\NormalTok{(reg.summary}\SpecialCharTok{$}\NormalTok{bic,}\AttributeTok{xlab=}\StringTok{"Number of Variables"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"BIC"}\NormalTok{,}\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{)}
\NormalTok{min }\OtherTok{\textless{}{-}} \FunctionTok{which.min}\NormalTok{(reg.summary}\SpecialCharTok{$}\NormalTok{bic)}
\FunctionTok{points}\NormalTok{(}\DecValTok{10}\NormalTok{,reg.summary}\SpecialCharTok{$}\NormalTok{bic[}\DecValTok{10}\NormalTok{],}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{cex=}\DecValTok{2}\NormalTok{,}\AttributeTok{pch=}\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-55-1.pdf} Since
BIC (Bayesian Information Criterion) does not change dramatically after
10th variable. We can use only 10 variables to decide satisfaction.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# choose 10 variable model}
\NormalTok{best\_model }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(regfit.full, }\AttributeTok{id =} \DecValTok{10}\NormalTok{) }
\NormalTok{abs\_coefficients }\OtherTok{\textless{}{-}} \FunctionTok{abs}\NormalTok{(best\_model)}
\NormalTok{sorted\_variables }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(}\FunctionTok{sort}\NormalTok{(abs\_coefficients, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))}
\NormalTok{column\_names }\OtherTok{\textless{}{-}}\NormalTok{ sorted\_variables[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{new\_X\_train }\OtherTok{\textless{}{-}}\NormalTok{ X\_train[, column\_names, drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]}
\NormalTok{new\_X\_test }\OtherTok{\textless{}{-}}\NormalTok{ X\_test[, column\_names, drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]}

\NormalTok{nb.fit }\OtherTok{\textless{}{-}} \FunctionTok{naiveBayes}\NormalTok{(}\AttributeTok{data =} \FunctionTok{data.frame}\NormalTok{(new\_X\_train),}
\NormalTok{                     y\_train }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .)}

\CommentTok{\# Make predictions on the test data}
\NormalTok{pred\_naive\_bayes }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(nb.fit, }\AttributeTok{newdata =}\NormalTok{ new\_X\_test)}

\CommentTok{\# Evaluate accuracy}
\FunctionTok{mean}\NormalTok{(pred\_naive\_bayes }\SpecialCharTok{==}\NormalTok{ y\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8770948
\end{verbatim}

The accuracy of model with 10 variables is higher. We can continue with
this model.

\hypertarget{k-nearest-neigbors-knn}{%
\subsection{K-Nearest Neigbors (KNN)}\label{k-nearest-neigbors-knn}}

K-Nearest Neighbors (KNN) is a supervised machine learning algorithm
used for classification and regression tasks. It is a non-parametric
algorithm, which means it doesn't make any assumptions about the
underlying distribution of the data. KNN is a simple yet powerful
algorithm that is widely used for its intuitive concept and easy
implementation.

The main idea behind KNN is to classify a new data point based on the
majority vote of its neighbors. The algorithm assumes that similar data
points tend to belong to the same class or have similar numerical
values. The ``K'' in KNN refers to the number of nearest neighbors that
are considered for classification or regression.

In this model, we used K-fold cross validation. Cross-validation is a
valuable technique in statistics and machine learning that helps assess
the performance of a model and select optimal hyperparameters.
Specifically, the K-fold cross-validation method is commonly employed
for this purpose.

During K-fold cross-validation, the training set is divided into K
equally sized subsets or ``folds.'' The model is then trained K times,
each time using K-1 of the folds as the training data and leaving one
fold as the validation set. This process is repeated K times, ensuring
that each fold serves as the validation set exactly once.

We can mention two benefits of k-fold cross validation. First, it allows
us to leverage the entire training dataset for both training and
validation. By iteratively rotating the folds, every data point gets an
opportunity to be in the validation set, providing a more comprehensive
evaluation of the model's performance.

Secondly, K-fold cross-validation helps to mitigate the potential bias
introduced by using a single validation set. When we reserve a separate
validation set, there is a risk that the performance estimation becomes
overly influenced by the specific data points in that set. By repeatedly
shuffling and partitioning the data into different folds, we obtain a
more robust estimate of the model's performance, as it is evaluated on
multiple distinct subsets of the data.

The final evaluation of the model is typically based on the average
performance across all K iterations. This averaging process helps to
reduce the variance in the performance estimate and provides a more
stable measure of the model's effectiveness.

We need to scale our data for two reasons. Firstly, scaling increases
the speed of training process. Secondly, if we do not scale the data,
the features with higher value will have more impact on predictions,
however, the features should have same weight and the change only should
be in range of 0-1.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Function for feature scaling}
\NormalTok{min\_max\_norm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{(x }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(x) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x))}
\NormalTok{\}}
\CommentTok{\# We normalize the columns}
\NormalTok{train\_scaled }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{lapply}\NormalTok{(train\_data, min\_max\_norm))}
\NormalTok{test\_scaled}\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{lapply}\NormalTok{(test\_data, min\_max\_norm))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# KNN with K{-}fold cross validation}

\CommentTok{\# Define a range of K values}
\NormalTok{k\_values }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}

\CommentTok{\# Perform cross{-}validation and calculate error rates}
\NormalTok{error\_rates }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(k\_values, }\ControlFlowTok{function}\NormalTok{(k) \{}
  \FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)  }\CommentTok{\# For reproducibility}
\NormalTok{  model }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(}\FunctionTok{as.factor}\NormalTok{(satisfaction)}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ train\_scaled, }
                 \AttributeTok{method =} \StringTok{"knn"}\NormalTok{, }
                 \AttributeTok{trControl =} \FunctionTok{trainControl}\NormalTok{(}\AttributeTok{method =} \StringTok{"cv"}\NormalTok{, }\AttributeTok{number =} \DecValTok{5}\NormalTok{),}
                 \AttributeTok{tuneGrid =} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{k =}\NormalTok{ k))}
  \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ model}\SpecialCharTok{$}\NormalTok{results}\SpecialCharTok{$}\NormalTok{Accuracy}
\NormalTok{\})}

\CommentTok{\# Plot the Error Rates}
\FunctionTok{plot}\NormalTok{(k\_values, error\_rates, }\AttributeTok{type =} \StringTok{"b"}\NormalTok{, }\AttributeTok{pch =} \DecValTok{16}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"K Value"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Error Rate"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"KNN: Error Rate vs. K Value"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/knn-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# find the k giving minimum error rate}
\NormalTok{k\_min }\OtherTok{\textless{}{-}} \FunctionTok{which.min}\NormalTok{(error\_rates)}
\NormalTok{k\_min}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# make predictions with k = k\_min }
\NormalTok{pred\_knn}\OtherTok{\textless{}{-}} \FunctionTok{knn}\NormalTok{(train\_scaled[,}\SpecialCharTok{{-}}\DecValTok{23}\NormalTok{], test\_scaled[,}\SpecialCharTok{{-}}\DecValTok{23}\NormalTok{],}
                \AttributeTok{cl =}\NormalTok{ train\_scaled}\SpecialCharTok{$}\NormalTok{satisfaction, }
                \AttributeTok{k =}\NormalTok{ k\_min)}
\end{Highlighting}
\end{Shaded}

\hypertarget{classification-results}{%
\section{Classification Results}\label{classification-results}}

\hypertarget{confusion-matrix-and-metrics}{%
\subsection{Confusion Matrix and
Metrics}\label{confusion-matrix-and-metrics}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a function for confusion matrix and other metrics}
\NormalTok{draw\_confusion\_matrix }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(cm) \{}

  \FunctionTok{layout}\NormalTok{(}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)))}
  \FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
  \FunctionTok{plot}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{345}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{300}\NormalTok{, }\DecValTok{450}\NormalTok{), }\AttributeTok{type =} \StringTok{"n"}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{xaxt=}\StringTok{\textquotesingle{}n\textquotesingle{}}\NormalTok{, }\AttributeTok{yaxt=}\StringTok{\textquotesingle{}n\textquotesingle{}}\NormalTok{)}
  \FunctionTok{title}\NormalTok{(}\StringTok{\textquotesingle{}CONFUSION MATRIX\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{2}\NormalTok{)}

  \CommentTok{\# create the matrix }
  \FunctionTok{rect}\NormalTok{(}\DecValTok{150}\NormalTok{, }\DecValTok{430}\NormalTok{, }\DecValTok{240}\NormalTok{, }\DecValTok{370}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}\#3F97D0\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{195}\NormalTok{, }\DecValTok{435}\NormalTok{, }\StringTok{\textquotesingle{}Unsatisfied\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
  \FunctionTok{rect}\NormalTok{(}\DecValTok{250}\NormalTok{, }\DecValTok{430}\NormalTok{, }\DecValTok{340}\NormalTok{, }\DecValTok{370}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}\#F7AD50\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{295}\NormalTok{, }\DecValTok{435}\NormalTok{, }\StringTok{\textquotesingle{}Satisfied\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{125}\NormalTok{, }\DecValTok{370}\NormalTok{, }\StringTok{\textquotesingle{}Predicted\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{srt=}\DecValTok{90}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{245}\NormalTok{, }\DecValTok{450}\NormalTok{, }\StringTok{\textquotesingle{}Actual\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{)}
  \FunctionTok{rect}\NormalTok{(}\DecValTok{150}\NormalTok{, }\DecValTok{305}\NormalTok{, }\DecValTok{240}\NormalTok{, }\DecValTok{365}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}\#F7AD50\textquotesingle{}}\NormalTok{)}
  \FunctionTok{rect}\NormalTok{(}\DecValTok{250}\NormalTok{, }\DecValTok{305}\NormalTok{, }\DecValTok{340}\NormalTok{, }\DecValTok{365}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}\#3F97D0\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{140}\NormalTok{, }\DecValTok{400}\NormalTok{, }\StringTok{\textquotesingle{}Unsatisfied\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{srt=}\DecValTok{90}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{140}\NormalTok{, }\DecValTok{335}\NormalTok{, }\StringTok{\textquotesingle{}Satisfied\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{srt=}\DecValTok{90}\NormalTok{)}

  \CommentTok{\# add in the cm results }
\NormalTok{  res }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{table)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{195}\NormalTok{, }\DecValTok{400}\NormalTok{, res[}\DecValTok{1}\NormalTok{], }\AttributeTok{cex=}\FloatTok{1.6}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{195}\NormalTok{, }\DecValTok{335}\NormalTok{, res[}\DecValTok{2}\NormalTok{], }\AttributeTok{cex=}\FloatTok{1.6}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{295}\NormalTok{, }\DecValTok{400}\NormalTok{, res[}\DecValTok{3}\NormalTok{], }\AttributeTok{cex=}\FloatTok{1.6}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{295}\NormalTok{, }\DecValTok{335}\NormalTok{, res[}\DecValTok{4}\NormalTok{], }\AttributeTok{cex=}\FloatTok{1.6}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{)}

  \CommentTok{\# add in the specifics }
  \FunctionTok{plot}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{0}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{0}\NormalTok{), }\AttributeTok{type =} \StringTok{"n"}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{main =} \StringTok{"DETAILS"}\NormalTok{, }\AttributeTok{xaxt=}\StringTok{\textquotesingle{}n\textquotesingle{}}\NormalTok{, }\AttributeTok{yaxt=}\StringTok{\textquotesingle{}n\textquotesingle{}}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{, }\FunctionTok{names}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{5}\NormalTok{]), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{30}\NormalTok{, }\DecValTok{30}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{5}\NormalTok{]), }\DecValTok{3}\NormalTok{), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{40}\NormalTok{, }\FunctionTok{names}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{7}\NormalTok{]), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{30}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{7}\NormalTok{]), }\DecValTok{3}\NormalTok{), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{70}\NormalTok{, }\DecValTok{40}\NormalTok{, }\FunctionTok{names}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{6}\NormalTok{]), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{font=}\DecValTok{2}\NormalTok{)}
  \FunctionTok{text}\NormalTok{(}\DecValTok{70}\NormalTok{, }\DecValTok{30}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(cm}\SpecialCharTok{$}\NormalTok{byClass[}\DecValTok{6}\NormalTok{]), }\DecValTok{3}\NormalTok{), }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}


\NormalTok{\}  }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Confusion matrix for glm\_full\_model}

\CommentTok{\# Use best threshold for prediction (0 or 1)}
\NormalTok{Threshold }\OtherTok{\textless{}{-}} \FloatTok{0.6}
\NormalTok{pred\_glm\_full\_factor }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(}\FunctionTok{ifelse}\NormalTok{(pred\_glm\_full }\SpecialCharTok{\textgreater{}=}\NormalTok{ Threshold , }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{))}


\NormalTok{conf\_matrix\_glm }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data =}\NormalTok{ pred\_glm\_full\_factor, }
                                     \AttributeTok{reference =} \FunctionTok{as.factor}\NormalTok{(y\_test))}
\FunctionTok{draw\_confusion\_matrix}\NormalTok{(conf\_matrix\_glm)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-61-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Confusion matrix for Naive Bayes}
\NormalTok{conf\_matrix\_naive }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data =}\NormalTok{ pred\_naive\_bayes, }
                                     \AttributeTok{reference =} \FunctionTok{as.factor}\NormalTok{(y\_test))}
\FunctionTok{draw\_confusion\_matrix}\NormalTok{(conf\_matrix\_naive)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-62-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Confusion matrix for KNN}
\NormalTok{conf\_matrix\_knn }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data =}\NormalTok{ pred\_knn, }\AttributeTok{reference =} \FunctionTok{as.factor}\NormalTok{(y\_test))}
\FunctionTok{draw\_confusion\_matrix}\NormalTok{(conf\_matrix\_knn)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Report_files/figure-latex/unnamed-chunk-63-1.pdf}

In our project, we want to find unsatisfied customers as precise as
possible. Because, our hypothesis is to increase total customer
satisfaction with low budget. Therefore, finding unsatisfied customers
and having less satisfied customer in our target will be the best
method. Considering that, precision metric will be most valuable metric.
Then we can count on F1 score, since it considers both Precision and
Recall into account.

KNN has the highest precision score rather than Naive Bayes and Logistic
Regression with full features model. However, KNN is an non-parametric
model and it does not have any bias related to hypothesis space.
Therefore, the complexity of model increases with number of samples.
Besides, we used cross-validation which also increases model complexity.
We can use a validation set approach to decrease training time.

\end{document}
